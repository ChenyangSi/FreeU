<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Free Lunch in Diffusion U-Net">
  <meta name="keywords" content="FreeU, Diffusion Model, Stable Diffusion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Free Lunch in Diffusion U-Net</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y5ZVQZ7NHC"></script> -->
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js_slide/fontawesome.all.min.js"></script>
  <script src="./static/js_slide/bulma-carousel.min.js"></script>
  <script src="./static/js_slide/bulma-slider.min.js"></script>
  <script src="./static/js_slide/index.js"></script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="./static/css/tab_gallery.css">
  <link rel="stylesheet" href="./static/css/juxtapose.css">
  <link rel="stylesheet" href="./static/css/image_card_fader.css">
  <link rel="stylesheet" href="./static/css/image_card_slider.css">
</head>
<body>




<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><span style="color:#5e5ed2; font-weight: bold; font-style: italic"><strong>FreeU</strong></span> : Free Lunch in Diffusion U-Net</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://chenyangsi.github.io/">Chenyang Si</a><sup></sup>,</span>
            <span class="author-block">
              <a href="https://ziqihuangg.github.io/">Ziqi Huang</a><sup></sup>,</span>
            <span class="author-block">
              <a href="https://yumingj.github.io/">Yuming Jiang</a><sup></sup>,
            </span>
            <span class="author-block">
              <a href="https://liuziwei7.github.io/">Ziwei Liu</a><sup></sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">S-Lab, Nanyang Technological University
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2309.11497.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2309.11497"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=-CZ5uWxvX30"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/ChenyangSi/FreeU"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span> -->
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================Teasers==========================-->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <!-- The expanding image container -->
      <!-- <h2 class="title is-3">Text to Image</h2> -->
      <div class="tab_container">
        <!-- Close the image -->
        <!-- <span onclick="this.parentElement.style.display='none'" class="closebtn">&times;</span> -->

        <!-- Expanded image -->
        <div id="juxtapose-embed" data-startingposition="30%" data-animate="true" class="juxtapose"
          style="height: 512px; width: 512px;">
          
        </div>

        <div>
          <div id="juxtapose-hidden"></div>
        </div>

        <!-- Image text -->
        <div id="imgtext"></div>
      </div>

      <!-- The grid: four columns -->
      <div class="tab_row">
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/1_freeu.png" onclick="tab_gallery_click('1');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/2_freeu.png" onclick="tab_gallery_click('2');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/3_freeu.png" onclick="tab_gallery_click('3');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/4_freeu.png" onclick="tab_gallery_click('4');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/5_freeu.png" onclick="tab_gallery_click('5');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/6_freeu.png" onclick="tab_gallery_click('6');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/7_freeu.png" onclick="tab_gallery_click('7');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/8_freeu.png" onclick="tab_gallery_click('8');">
        </div>
      </div>
      <div class="content has-text-justified">
        <p>
          We propose <strong>FreeU</strong>, a method that substantially improves diffusion model sample quality at no costs: no training, no additional parameter introduced, and no increase in memory or sampling time.
      </div>
    </div>
  </div>
</section>

<!--=================paper Video==========================-->
<section class="hero is-light is-small">
  <div class="columns is-centered has-text-centered"  style="margin-top: 10px; margin-bottom: 20px;">
    <div class="column is-three-fifths">
      <h2 class="title is-3">Video</h2>
      
      <div class="publication-video">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/-CZ5uWxvX30?si=mfDrwGAvHEpAt232" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>
      
      <!-- <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./demo_video_v5.mp4"
                type="video/mp4">
      </video> -->

    </div>
  </div>
</section>


<!-- <section class="section">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="content has-text-justified">
          <div style="text-align: center; vertical-align:middle">
            <video id="teaser" autoplay muted loop playsinline height="100%">
              <source src="./demo_video_v5.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div align="center">
            <b>Samples generated by ModelScope with or without FreeU.</b>
        </div>
      </div>
    </div>
  </div>
</section> -->


<!--=================Abstract==========================-->
<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In this paper, we uncover the untapped potential of diffusion U-Net, which serves as a <strong>"free lunch"</strong> that substantially improves the generation quality on the fly. We initially investigate the key contributions of the U-Net architecture to the denoising process and identify that its main backbone primarily contributes to denoising, whereas its skip connections mainly introduce high-frequency features into the decoder module, causing the network to overlook the backbone semantics. Capitalizing on this discovery, we propose a simple yet effective method-termed <strong>"FreeU"</strong> - that enhances generation quality without additional training or finetuning. Our key insight is to strategically re-weight the contributions sourced from the U-Net's skip connections and backbone feature maps, to leverage the strengths of both components of the U-Net architecture. Promising results on image and video generation tasks demonstrate that our FreeU can be readily integrated to existing diffusion models, e.g., Stable Diffusion, DreamBooth, ModelScope, Rerender and ReVersion, to improve the generation quality with only a few lines of code. <strong>All you need is to adjust two scaling factors during inference.</strong>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>

<!--/ Framework. -->
<section class="section" style="margin-top:-120px;">
  <div class="container is-max-desktop">
    <div class="hero-body">
        <div class="section-title has-text-centered" >
          <h2 class="title is-3 is-centered">FreeU Framework</h2>
        </div>
        <div class="columns is-centered has-text-centered">
          <div class="column">
            <div class="publication-img">
              <img id="architecture" src="./freeu_img_vid/framework.png" style="width:600px; margin-top:10px;margin-bottom:10px;"/>
            </div>
          </div>
        </div>
        <p>
          We propose FreeU, a method that substantially improves diffusion model sample quality at no costs: no training, no additional
          parameter introduced, and no increase in memory or sampling time.
        </p>
    </div>
  </div>
</section>



<!--=================SD Results==========================-->
<!-- <section class="section" style="background-color: #f1f1f1;">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Text to Image</h2>
        <div class="content has-text-justified">
          <div style="text-align: center; vertical-align:middle">
            <img src="t2i/sd.png" width="2000">
          </div>
          <div align="center">
            <b>Samples generated by Stabel Diffusion with or without FreeU.</b>
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->


<!-- Diverse Relations -->
<section class="section" style="background-color: #f1f1f1;">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Text to Image</h2>
        <h2 class="subtitle has-text-centered">Samples generated by Stable Diffusion with or without FreeU.</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-puppet">
            <div class="carousel-content">
              <img src="freeu_img_vid/t2i/sd.png"
                      alt="Puppet."/>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <img src="freeu_img_vid/t2i/sd2.png"
                      alt="Round-bird."/>
            </div>
          </div>
          <div class="item item-round_sd">
            <div class="carousel-content">
              <img src="freeu_img_vid/t2i/sd3.png"
                      alt="Round-sd."/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
</section>



<!--=================t2v Results==========================-->
<section class="section">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Text to Video</h2>
        <h2 class="subtitle has-text-centered">Samples generated by ModelScope with or without FreeU.</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-puppet">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="./freeu_img_vid/t2v/video1.mp4" 
                       alt="Puppet."/>
              </video>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="./freeu_img_vid/t2v/video2.mp4" 
                        alt="Round-bird."/>
              </video>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>  
</section>



<!--=================dreambooth Results==========================-->
<section class="section" style="background-color: #f1f1f1;">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Personalized Text to Image</h2>
        <h2 class="subtitle has-text-centered">Samples generated by DreamBooth with or without FreeU.</h2>
        <div class="content has-text-justified">
          <div style="text-align: center; vertical-align:middle">
            <img src="freeu_img_vid/dreambooth/dreambooth1.png" width="1000">
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================reversion Results==========================-->
<section class="section">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Relation Inversion</h2>
        <h2 class="subtitle has-text-centered">Samples generated by ReVersion with or without FreeU.</h2>
        <div class="content has-text-justified">
          <div style="text-align: center; vertical-align:middle">
            <img src="freeu_img_vid/reversion/reversion1.png" width="1000">
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
  
<!--=================Rerender Video==========================-->
<!-- <section class="section">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Personalized Text to Image</h2>
        <h2 class="subtitle has-text-centered">Samples generated by Rerender with or without FreeU.</h2>
        <div class="content has-text-justified">
          <div style="text-align: center; vertical-align:middle">
            <img src="rerender/rerender1.png" width="800">
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->

<section class="section" style="background-color: #f1f1f1;">
  <div class="columns is-centered has-text-centered"  style="margin-top: 10px; margin-bottom: 20px;">
    <div class="column is-three-fifths">
      <h2 class="title is-3">Video-to-Video</h2>
      <h2 class="subtitle has-text-centered">Samples generated by Rerender with or without FreeU.</h2>
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./freeu_img_vid/rerender/rerender1.mp4"
                type="video/mp4">
      </video>

    </div>
  </div>
</section>
    

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{Si2023FreeU,
  author    = {Chenyang Si, Ziqi Huang, Yuming Jiang, Ziwei Liu},
  title     = {FreeU: Free Lunch in Diffusion U-Net},
  journal   = {arXiv },
  year      = {2023},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Image Slider Javascripts -->
<!--=================Functions==========================-->
<script src="static/js/juxtapose.js"></script>

<script>
  var slider;
  let origImages = [
    { "src": "freeu_img_vid/t2i/1_sd.png", "label": "SD", },
    { "src": "freeu_img_vid/t2i/1_freeu.png", "label": "SD+FreeU", }
  ];
  let origOptions = {
    "makeResponsive": true,
    "showLabels": true,
    "mode": "horizontal",
    "showCredits": true,
    "animate": true,
    "startingPosition": "50"
  };

  const juxtaposeSelector = "#juxtapose-embed";
  const transientSelector = "#juxtapose-hidden";

  
  function tab_gallery_click(name) {
    // Get the expanded image
    let inputImage = {
      label: "SD",
    };
    let outputImage = {
      label: "SD+FreeU",
    };

    inputImage.src = "freeu_img_vid/t2i/".concat(name, "_sd", ".png")
    outputImage.src = "freeu_img_vid/t2i/".concat(name, "_freeu", ".png")

    let images = [inputImage, outputImage];
    let options = slider.options;
    options.callback = function (obj) {
      var newNode = document.getElementById(obj.selector.substring(1));
      var oldNode = document.getElementById(juxtaposeSelector.substring(1));
      console.log(obj.selector.substring(1));
      console.log(newNode.children[0]);
      oldNode.replaceChild(newNode.children[0], oldNode.children[0]);
      //newNode.removeChild(newNode.children[0]);

    };

    slider = new juxtapose.JXSlider(transientSelector, images, options);
  };

  (function () {
    slider = new juxtapose.JXSlider(
      juxtaposeSelector, origImages, origOptions);
    //document.getElementById("left-button").onclick = replaceLeft;
    //document.getElementById("right-button").onclick = replaceRight;
  })();
  // Get the image text
  var imgText = document.getElementById("imgtext");
  // Use the same src in the expanded image as the image being clicked on from the grid
  // expandImg.src = imgs.src;
  // Use the value of the alt attribute of the clickable image as text inside the expanded image
  imgText.innerHTML = name;
  // Show the container element (hidden with CSS)
  // expandImg.parentElement.style.display = "block";

  $(".flip-card").click(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("out");
    $(div_front).removeClass("in");

    $(div_back).addClass("in");
    $(div_back).removeClass("out");

  });

  $(".flip-card").mouseleave(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("in");
    $(div_front).removeClass("out");

    $(div_back).addClass("out");
    $(div_back).removeClass("in");

  });
</script>


</body>
</html>


